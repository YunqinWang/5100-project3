<!DOCTYPE html>
<html>

<head lang="en">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <style>
        .state {
            fill: lightgrey;
        }

        .outline {
            stroke: black;
            stroke-width: 1px;
            fill: none;
        }

        .graticule {
            fill: none;
            stroke: grey;
            stroke-width: 1px;
        }
    </style>
    <title>Info5100 Project3</title>
</head>

<body>
    <svg id="map" width="900" height="850" style="background: gray"></svg>
    <script>
        const svg = d3.select("svg#map");

        const width = svg.attr("width");
        const height = svg.attr("height");
        const margin = { top: 10, right: 10, bottom: 20, left: 20 };
        const mapWidth = width - margin.left - margin.right;
        const mapHeight = height - margin.top - margin.bottom;
        const map = svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        const requestData = async function () {
            const us = await d3.json('https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json');
            console.log(us)
            var states = topojson.feature(us, us.objects.states);
            var statesMesh = topojson.mesh(us, us.objects.states);
            console.log(statesMesh)
            var projection = d3.geoAlbersUsa().fitSize([mapWidth, mapHeight], states);
            var path = d3.geoPath().projection(projection);

            let graticule = d3.geoGraticule10();
            map.append("path").attr("class", "graticule").attr("d", path(graticule))

            map.selectAll("path.state").data(states.features)
                .join("path")
                .attr("class", "state")
                .attr('id', (d) => d.properties.name)
                .attr("d", path)

            map.append("path").datum(statesMesh)
                .attr("class", "outline")
                .attr("d", path);
        }
        requestData()
    </script>
</body>

</html>